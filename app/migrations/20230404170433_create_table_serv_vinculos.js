exports.up = function(knex) {
    return knex.schema.createTable('wwmgca_cliente_ativos.serv_vinculos', table => {
        table.engine('InnoDB')
        table.charset('utf8mb4')
        table.collate('utf8mb4_general_ci')
        table.increments('id').primary()
        table.integer('status').notNull().default(10)
        table.integer('evento').notNull()
        table.string('created_at').notNull()
        table.string('updated_at')
        table.string('ini_valid', 7).notNull().comment("Início da Validade das Informações")
        table.integer('id_serv').notNull().unsigned().comment("Servidor")
        table.integer('id_vinc_principal').notNull().unsigned().comment("Vinculo Principal")
        table.string('matricula', 30).notNull().comment("Matrícula do Trabalhador")
        table.string('sit_func', 30).notNull().comment("1-Ativo; 2-Aposentado; 3-Pensionista")
        table.boolean('tp_reg_trab').notNull().comment("Tipo Regime Trabalhista: CLT=1, Estatutário=2")
        table.boolean('tp_reg_prev').notNull().comment("Tipo Regime Previdenciário")
        table.integer('id_param_tp_prov').notNull().unsigned().comment("Vínculo Trabalhista")
        table.specificType('data_exercicio', 'char(10)').notNull().comment("Data da Entrada em Exercício")
        table.boolean('tp_plan_rp').comment("Plano Segregação da Massa")
        table.string('teto_rgps', 1).comment("S-Sim, N-Não")
        table.string('abono_perm', 1).comment("S-Sim, N-Não / Abono Permanência")
        table.specificType('d_inicio_abono', 'char(10)').comment("Data de Início Abono")
        table.specificType('d_ing_cargo', 'char(10)').comment("Data de Ingresso no Cargo")
        table.integer('id_cargo').notNull().unsigned().comment("Cargo")
        table.string('acum_cargo', 1).comment("S-Sim, N-Não / Acumulável")
        table.integer('id_param_cod_categ').notNull().unsigned().comment("Código da Categoria")
        table.string('qtd_hr_sem', 4).comment("Quantidade de Horas Semanais")
        table.integer('id_param_tp_jor').notNull().unsigned().comment("Tipo de Jornada")
        table.integer('id_param_tmp_parc').notNull().unsigned().comment("Tempo Parcial")
        table.string('hr_noturno', 1).notNull().default("N").comment("S-Sim, N-Não")
        table.string('desc_jornd', 999).comment("Descrição de Jornada")
        table.string('pis').comment("PIS")
        table.specificType('dt_pis', 'char(10)').comment("Data do PIS")
        table.specificType('tempo_servico', 'char(10)').comment("Tempo de Serviço")
        table.specificType('tempo_final', 'char(10)').comment("Tempo Final")
        table.string('titulo').comment("Título")
        table.string('tit_uf').comment("UF do Título")
        table.string('tit_zona').comment("Zona do Título")
        table.string('tit_secao').comment("Seção do Título")
        table.specificType('dt_nomeacao', 'char(10)').comment("Data da Nomeação")
        table.string('nom_edital').comment("Nome do Edital")
        table.string('nom_nr_inscr').comment("Número Inscrição")
        table.integer('id_param_grau_exp').unsigned().comment("Grau de Exposição")
        table.specificType('siap_data_criacao', 'char(10)').comment("Data de criação")
        table.specificType('siap_data_ato', 'char(10)').comment("Data do ato de criação")
        table.string('siap_ato').comment("Número do ato de criação")
        table.integer('id_param_v_pub').unsigned().comment("Veículo de Publicação do ato de criação")
        //table.integer('id_siap_pub').unsigned().comment("Publicação")

        table.unique(['ini_valid', 'id_serv', 'matricula'])
        table.foreign('id_serv').references('id').inTable('servidores').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_param_tp_prov').references('id').inTable('wwmgca_app.params').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_cargo').references('id').inTable('aux_cargos').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_param_cod_categ').references('id').inTable('wwmgca_app.params').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_param_tp_jor').references('id').inTable('wwmgca_app.params').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_param_tmp_parc').references('id').inTable('wwmgca_app.params').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_param_grau_exp').references('id').inTable('wwmgca_app.params').onUpdate('CASCADE').onDelete('NO ACTION')
        table.foreign('id_param_v_pub').references('id').inTable('wwmgca_app.params').onUpdate('CASCADE').onDelete('NO ACTION')
        //table.foreign('id_siap_pub').references('id').inTable('siap_publicacoes').onUpdate('CASCADE').onDelete('NO ACTION')
    })
};

exports.down = function(knex) {
    return knex.schema.dropTable('wwmgca_cliente_ativos.serv_vinculos')
};